## 🚀 Luego puedes iniciar el microservicio:

    npm start

    (para correr en modo debug, cuando hay errores):
         DEBUG=* npm start


## 🚀 Microservicio Completo Implementado
### Endpoints Disponibles:
1. 1.
   POST /api/send-appointment-message
   
   - Envía mensajes de citas médicas con formato profesional
   - Tipos: confirmation , reminder , urgent_reminder , cancellation
   - Formateo automático de números argentinos
2. 2.
   GET /api/qr-code
   
   - Obtiene el código QR para setup inicial
   - Indica si ya está conectado
3. 3.
   GET /api/health
   
   - Estado completo del servicio
   - Información de conexión WhatsApp
   - Lista de endpoints disponibles



### Ejemplo de uso:
```
# Enviar confirmación de cita
curl -X POST http://localhost:3000/api/send-appointment-message \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "+54 9 2346 33-4077",
    "messageType": "confirmation",
    "appointmentData": {
      "patient": "Ana García",
      "professional": "Dr. Juan Pérez",
      "service": "Consulta Cardiológica",
      "date": "15 de Enero 2024",
      "time": "14:30",
      "location": "Clínica San José - Consultorio 205"
    }
}

```


# 🏗️ Arquitectura del Microservicio WhatsApp
## 📋 Estructura General
├── server.js           # Servidor principal + endpoints específicos
├── routes/
│   ├── index.js        # Rutas web (frontend)
│   └── whatsapp.js     # API WhatsApp genérica
├── services/
│   └── whatsappService.js  # Lógica de conexión WhatsApp
├── utils/
│   ├── MessageBuilder.js   # Constructor de mensajes
│   └── logger.js          # Sistema de logs
└── public/             # Archivos estáticos

## 🔌 Endpoints Disponibles
### 📱 Endpoints Principales (server.js)
- POST /api/send-appointment-message - Envío de mensajes de citas médicas
- GET /api/qr-code - Obtener QR para conectar WhatsApp
- GET /api/health - Estado del servicio

### 🛠️ API WhatsApp Genérica (/api/whatsapp/)
- GET /status - Estado de conexión
- GET /qr - QR code alternativo
- POST /send-message - Envío genérico de mensajes
- GET /contacts - Lista de contactos
- GET /groups - Lista de grupos
- POST /logout - Cerrar sesión


## ⚙️ Componentes Clave
### WhatsAppService
- Maneja conexión con Baileys
- Persistencia de sesión ( auth_info_baileys/ )
- Auto-reconexión
- Generación de QR codes
### MessageBuilder
- Construye mensajes de citas: confirmation , reminder , urgent_reminder , cancellation
- Soporte para texto, imágenes, documentos
- Formateo de números telefónicos argentinos
### Seguridad & Límites
- Rate limiting: 30 msg/min, 100 req/min
- CORS configurado
- Helmet para seguridad
- Validación con Joi
## 🎯 Flujo Principal
1. 1.
   Setup : GET /api/qr-code → Escanear QR
2. 2.
   Verificar : GET /api/health → Estado de conexión
3. 3.
   Enviar : POST /api/send-appointment-message → Mensaje de cita